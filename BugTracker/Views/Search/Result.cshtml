@model SearchResultsViewModel

@{
    ViewBag.Title = "Search Results";
}

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css" />

<!-- Collapsible advanced search region -->
<div class="advanced-search">
    <button class="btn btn-primary" data-toggle="collapse" type="button" data-target="#advancedSearchCollapse" aria-expanded="false" aria-controls="advancedSearchCollapse">
        Advanced Search
    </button>
    <div class="collapse" id="advancedSearchCollapse">

        <div class="card card-body">

            <form class="form" asp-controller="Search" asp-action="Result" method="post">

                <!-- Search input -->
                <div class="form-group row ml-1">
                    <input asp-for="@Model.SearchExpression.SearchText" id="searchString" class="form-control mr-sm-2" type="text" placeholder="@Model.SearchExpression.SearchText" aria-label="Search" />
                </div>

                <!-- search in posts / titles -->
                <div class="form-group row ml-3">
                    <div class="content-check">
                        <input type="checkbox" id="details-check" class="form-check-input" asp-for="@Model.SearchExpression.SearchInDetails">
                        <label class="form-check-label" for="details-check">Titles and content</label>
                    </div>
                </div>

                <!-- Date range picker -->
                <div class="form-group row">
                    <p>From: </p>
                    <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                        <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1" asp-for="@Model.SearchExpression.DateRangeBegin"/>
                        <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                        </div>
                    </div>
                    <p>To: </p>
                    <div class="input-group date" id="datetimepicker2" data-target-input="nearest">
                        <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker2" asp-for="@Model.SearchExpression.DateRangeEnd"/>
                        <div class="input-group-append" data-target="#datetimepicker2" data-toggle="datetimepicker">
                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                        </div>
                    </div>
                </div>
                <script type="text/javascript">
                    $(function () {
                        $('#datetimepicker1').datetimepicker();
                        $('#datetimepicker2').datetimepicker();
                    });
                </script>

                <!-- Submit button -->
                <div class="form-group row row ml-1">
                    <button class="btn btn-primary" type="submit">Search</button>
                </div>

            </form>
        </div>
    </div>
</div>


<h3>Search Results: @Model.SearchExpression.SearchText - @Model.SearchResults.Count</h3>

@{
    foreach (var result in Model.SearchResults)
    {
        <div class="row col-12">
            <div class="card m-3 w-100">
                <div class="card-header">
                    <h3>@result.Title</h3>
                </div>

                <div class="card-body">
                    <p>@result.CreationTime</p>

                    <!-- Whole card links to bug report -->
                    <a asp-controller="BugReport" asp-action="ReportOverview" asp-route-id="@result.BugReportId" class="stretched-link"></a>
                </div>

            </div>
        </div>
    }
}

